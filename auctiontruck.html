<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>หน้าเว็บฝากโพสประมูลงาน</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;700&display=swap" rel="stylesheet">
  <style>
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .animate-fade-in {
      animation: fadeIn 0.8s ease-out;
    }
    .min-h-screen {
        min-height: 100vh;
    }
    body {
        font-family: 'Kanit', sans-serif;
    }
  </style>
</head>
<body class="bg-gradient-to-br from-green-50 to-emerald-100 antialiased">

  <div id="root"></div>

  <script type="text/babel">
    const { useState } = React;

    // Hardcoded list of 77 provinces of Thailand
    const provinces = [
      "กรุงเทพมหานคร", "กระบี่", "กาญจนบุรี", "กาฬสินธุ์", "กำแพงเพชร", "ขอนแก่น", "จันทบุรี", "ฉะเชิงเทรา", "ชลบุรี", "ชัยนาท",
      "ชัยภูมิ", "ชุมพร", "เชียงราย", "เชียงใหม่", "ตรัง", "ตราด", "ตาก", "นครนายก", "นครปฐม", "นครพนม",
      "นครราชสีมา", "นครศรีธรรมราช", "นครสวรรค์", "นนทบุรี", "นราธิวาส", "น่าน", "บึงกาฬ", "บุรีรัมย์", "ปทุมธานี", "ประจวบคีรีขันธ์",
      "ปราจีนบุรี", "ปัตตานี", "พระนครศรีอยุธยา", "พะเยา", "พังงา", "พัทลุง", "พิจิตร", "พิษณุโลก", "เพชรบุรี", "เพชรบูรณ์",
      "แพร่", "ภูเก็ต", "มหาสารคาม", "มุกดาหาร", "แม่ฮ่องสอน", "ยโสธร", "ยะลา", "ร้อยเอ็ด", "ระนอง", "ระยอง",
      "ราชบุรี", "ลพบุรี", "ลำปาง", "ลำพูน", "เลย", "ศรีสะเกษ", "สกลนคร", "สงขลา", "สตูล", "สมุทรปราการ",
      "สมุทรสงคราม", "สมุทรสาคร", "สระแก้ว", "สระบุรี", "สิงห์บุรี", "สุโขทัย", "สุพรรณบุรี", "สุราษฎร์ธานี", "สุรินทร์", "หนองคาย",
      "หนองบัวลำภู", "อ่างทอง", "อำนาจเจริญ", "อุดรธานี", "อุตรดิตถ์", "อุทัยธานี", "อุบลราชธานี"
    ];

    // InputField and SelectField components are moved outside to prevent re-creation on every render
    const InputField = ({ label, name, type = 'text', required = false, error, placeholder, value, onChange }) => (
      <div className="mb-6">
        <label className="block text-gray-700 text-sm font-semibold mb-2">
          {label} {required && <span className="text-red-500">*</span>}
        </label>
        <input
          type={type}
          name={name}
          value={value}
          onChange={onChange}
          className={`shadow-inner appearance-none border-2 border-gray-200 rounded-xl w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-4 focus:ring-green-200 focus:border-green-400 transition-all duration-200 ${error ? 'border-red-500' : ''}`}
          placeholder={placeholder}
          required={required}
        />
        {error && <p className="text-red-500 text-xs italic mt-1">{error}</p>}
      </div>
    );

    const SelectField = ({ label, name, options, required = false, value, onChange }) => (
      <div className="mb-6">
        <label className="block text-gray-700 text-sm font-semibold mb-2">
          {label} {required && <span className="text-red-500">*</span>}
        </label>
        <select
          name={name}
          value={value}
          onChange={onChange}
          className="shadow-inner appearance-none border-2 border-gray-200 rounded-xl w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-4 focus:ring-green-200 focus:border-green-400 transition-all duration-200"
        >
          <option value="">-- กรุณาเลือก --</option>
          {options.map(option => (
            <option key={option} value={option}>{option}</option>
          ))}
        </select>
      </div>
    );

    // Main App component to manage the multi-step form and data
    const App = () => {
      // State to manage the current step of the form
      const [currentPage, setCurrentPage] = useState('disclaimer');
      // State to store the contact information
      const [contactData, setContactData] = useState({});
      // State to store all the submitted job details
      const [jobDetails, setJobDetails] = useState([]);
      // State to show success message after final submission
      const [submissionSuccess, setSubmissionSuccess] = useState(false);

      // Component for the disclaimer page
      const DisclaimerPage = () => (
        <div className="flex flex-col items-center justify-center p-8 bg-white rounded-2xl shadow-2xl max-w-2xl mx-auto my-12 animate-fade-in">
          <p className="text-sm md:text-base text-gray-700 leading-relaxed text-justify mb-8">
            บริษัท เอสเอสแอล โลจิสติกส์ จำกัด ("บริษัทฯ") ทำหน้าที่เป็นเพียง ตัวกลาง ในการประสานงานและส่งต่อข้อเสนอราคาค่าขนส่งระหว่างผู้ยื่นประมูลกับบริษัทต้นทางเท่านั้น บริษัทฯ ไม่ได้เป็นคู่สัญญาในงานขนส่ง การอนุมัติและคัดเลือกราคาค่าขนส่งทั้งหมดเป็นดุลยพินิจของบริษัทต้นทางแต่เพียงผู้เดียว ดังนั้น บริษัทฯ จะไม่รับผิดชอบต่อความเสียหาย ค่าใช้จ่าย หรือหนี้สินใด ๆ ที่เกิดขึ้นจากการขนส่งเป็นความรับผิดชอบของผู้ได้สัญญาขนส่งแต่เพียงผู้เดียว
          </p>
          <button
            onClick={() => setCurrentPage('contact')}
            className="px-10 py-4 bg-gradient-to-r from-teal-500 to-green-600 text-white font-bold rounded-full shadow-lg hover:from-teal-600 hover:to-green-700 transform transition-all duration-300 hover:scale-105 focus:outline-none focus:ring-4 focus:ring-teal-500 focus:ring-opacity-50"
          >
            ยอมรับเงื่อนไข
          </button>
        </div>
      );

      // Component for the contact information form
      const ContactForm = () => {
        const [form, setForm] = useState({ companyName: '', contactName: '', phone: '', email: '' });
        const [errors, setErrors] = useState({});

        const handleChange = (e) => {
          const { name, value } = e.target;
          setForm({ ...form, [name]: value });
        };

        const validate = () => {
          const newErrors = {};
          if (!form.companyName) newErrors.companyName = 'กรุณากรอกชื่อบริษัท';
          if (!form.contactName) newErrors.contactName = 'กรุณากรอกชื่อผู้ติดต่อ';
          if (!form.phone) {
            newErrors.phone = 'กรุณากรอกเบอร์โทรศัพท์';
          } else if (!/^\d{1,10}$/.test(form.phone)) {
            newErrors.phone = 'เบอร์โทรศัพท์ต้องเป็นตัวเลขไม่เกิน 10 หลัก';
          }
          if (!form.email) {
            newErrors.email = 'กรุณากรอก E-mail';
          } else if (!/\S+@\S+\.\S+/.test(form.email)) {
            newErrors.email = 'รูปแบบ E-mail ไม่ถูกต้อง';
          }
          setErrors(newErrors);
          return Object.keys(newErrors).length === 0;
        };

        const handleSubmit = (e) => {
          e.preventDefault();
          if (validate()) {
            setContactData(form);
            setCurrentPage('job_details');
          }
        };

        return (
          <div className="flex flex-col items-center justify-center p-8 bg-white rounded-2xl shadow-2xl max-w-2xl mx-auto my-12 animate-fade-in">
            <h2 className="text-2xl md:text-3xl font-extrabold text-gray-800 mb-6 text-center">กรอกข้อมูลผู้ติดต่อ</h2>
            <form onSubmit={handleSubmit} className="w-full">
              <InputField
                label="ชื่อบริษัท ที่ต้องการให้เสนองานประมูล"
                name="companyName"
                placeholder="ชื่อบริษัท"
                required={true}
                error={errors.companyName}
                value={form.companyName}
                onChange={handleChange}
              />
              <InputField
                label="ชื่อผู้ติดต่อประสานงาน"
                name="contactName"
                placeholder="ชื่อผู้ติดต่อ"
                required={true}
                error={errors.contactName}
                value={form.contactName}
                onChange={handleChange}
              />
              <InputField
                label="เบอร์โทรศัพท์"
                name="phone"
                type="tel"
                placeholder="เบอร์โทรศัพท์ (ตัวเลขไม่เกิน 10 หลัก)"
                required={true}
                error={errors.phone}
                value={form.phone}
                onChange={handleChange}
              />
              <InputField
                label="E-mail"
                name="email"
                type="email"
                placeholder="E-mail"
                required={true}
                error={errors.email}
                value={form.email}
                onChange={handleChange}
              />
              <div className="flex justify-center mt-8">
                <button
                  type="submit"
                  className="px-10 py-4 bg-gradient-to-r from-emerald-500 to-green-600 text-white font-bold rounded-full shadow-lg hover:from-emerald-600 hover:to-green-700 transform transition-all duration-300 hover:scale-105 focus:outline-none focus:ring-4 focus:ring-green-400 focus:ring-opacity-50"
                >
                  ยืนยัน
                </button>
              </div>
            </form>
          </div>
        );
      };

      // Component for the job details form
      const JobDetailsForm = () => {
        const [form, setForm] = useState({
          vehicleType1: '',
          vehicleType2: '',
          shippingType: '',
          origin: '',
          destination: '',
          productType: '',
          weight: '',
          otherDetails: '',
        });
        const [errors, setErrors] = useState({});
        const [message, setMessage] = useState('');
        const [isSubmitting, setIsSubmitting] = useState(false);
        const [submittedCount, setSubmittedCount] = useState(0);

        const handleChange = (e) => {
          const { name, value } = e.target;
          setForm(prevForm => ({ ...prevForm, [name]: value }));
          if (message) setMessage('');
        };

        const validate = () => {
          const newErrors = {};
          if (!form.productType) newErrors.productType = 'กรุณากรอกประเภทสินค้า';
          if (!form.weight || isNaN(form.weight)) newErrors.weight = 'กรุณากรอกน้ำหนักสินค้า (ตัวเลขเท่านั้น)';
          setErrors(newErrors);
          return Object.keys(newErrors).length === 0;
        };

        const handleAddJob = (e) => {
          e.preventDefault();
          if (validate()) {
            const newJob = {
              ...form,
              weight: Number(form.weight),
            };
            setJobDetails([...jobDetails, newJob]);
            setForm({ // Reset form fields after successful add
                vehicleType1: '',
                vehicleType2: '',
                shippingType: '',
                origin: '',
                destination: '',
                productType: '',
                weight: '',
                otherDetails: '',
            });
            setMessage('ข้อมูลถูกเพิ่มแล้ว! คุณสามารถเพิ่มข้อมูลการขนส่งเพิ่มเติมได้');
          }
        };

        const handleRemoveJob = (index) => {
          setJobDetails(jobDetails.filter((_, i) => i !== index));
        };

        // This function now handles submitting data to Google Sheets via Google Forms
        const handleFinalSubmit = async () => {
          if (jobDetails.length === 0) {
            setMessage('กรุณาเพิ่มข้อมูลการขนส่งอย่างน้อย 1 รายการก่อนกดยืนยัน');
            return;
          }

          setIsSubmitting(true);
          setSubmittedCount(0);
          
          const GOOGLE_FORM_ACTION_URL = 'https://docs.google.com/forms/d/e/1FAIpQLSePq1AmfDjHfZyNwRurYHi6cWoJ35RAsP21gLye0FL2EuvJuA/formResponse';
          
          let allSubmissionsSuccessful = true;
          for (const job of jobDetails) {
            const formData = new FormData();
            
            // Add contact data to the FormData object (will be the same for all jobs)
            formData.append('entry.458433396', contactData.companyName);
            formData.append('entry.855540336', contactData.contactName);
            formData.append('entry.393776293', contactData.phone);
            formData.append('entry.1514151359', contactData.email);

            // Add job-specific data to the FormData object
            formData.append('entry.1135972793', job.vehicleType1);
            formData.append('entry.1338986664', job.vehicleType2);
            formData.append('entry.677696846', job.shippingType);
            formData.append('entry.2001671780', job.origin);
            formData.append('entry.1271251164', job.destination);
            formData.append('entry.738846975', job.productType);
            formData.append('entry.525330776', job.weight);
            formData.append('entry.2023531764', job.otherDetails);

            try {
              await fetch(GOOGLE_FORM_ACTION_URL, {
                method: 'POST',
                mode: 'no-cors',
                body: formData,
              });
              setSubmittedCount(prev => prev + 1);
            } catch (error) {
              console.error('Error submitting form:', error);
              allSubmissionsSuccessful = false;
            }
          }

          setIsSubmitting(false);
          if (allSubmissionsSuccessful) {
            setSubmissionSuccess(true);
          } else {
            setMessage('เกิดข้อผิดพลาดในการส่งข้อมูลบางรายการ กรุณาลองใหม่อีกครั้ง');
          }
        };

        return (
          <div className="flex flex-col items-center justify-center p-8 bg-white rounded-2xl shadow-2xl max-w-2xl mx-auto my-12 animate-fade-in">
            <h2 className="text-2xl md:text-3xl font-extrabold text-gray-800 mb-6 text-center">ข้อมูลการขนส่ง</h2>
            <form onSubmit={handleAddJob} className="w-full">
              <SelectField
                label="ประเภทรถ 1"
                name="vehicleType1"
                options={['4 ล้อ', '6 ล้อ', '10 ล้อ', 'เทรลเลอร์']}
                value={form.vehicleType1}
                onChange={handleChange}
              />
              <SelectField
                label="ประเภทรถ 2"
                name="vehicleType2"
                options={['พื้นเรียบ', 'คอก', 'ตู้', 'ตู้เย็น']}
                value={form.vehicleType2}
                onChange={handleChange}
              />
              <SelectField
                label="ประเภทการขนส่ง"
                name="shippingType"
                options={['เหมาเที่ยว', 'กระจายสินค้า', 'Express', 'Cross border']}
                value={form.shippingType}
                onChange={handleChange}
              />
              <SelectField
                label="ต้นทาง (จังหวัด)"
                name="origin"
                options={provinces}
                value={form.origin}
                onChange={handleChange}
              />
              <SelectField
                label="ปลายทาง (จังหวัด)"
                name="destination"
                options={provinces}
                value={form.destination}
                onChange={handleChange}
              />
              <InputField
                label="ประเภทสินค้า"
                name="productType"
                placeholder="สินค้าทั่วไป, เครื่องจักร, ฯลฯ"
                required={true}
                error={errors.productType}
                value={form.productType}
                onChange={handleChange}
              />
              <InputField
                label="น้ำหนักสินค้า (กิโลกรัม)"
                name="weight"
                type="number"
                placeholder="เป็นตัวเลขเท่านั้น"
                required={true}
                error={errors.weight}
                value={form.weight}
                onChange={handleChange}
              />
              <div className="mb-6">
                <label className="block text-gray-700 text-sm font-semibold mb-2">
                  รายละเอียดอื่นๆ (มีไม่มีก็ได้)
                </label>
                <textarea
                  name="otherDetails"
                  value={form.otherDetails}
                  onChange={handleChange}
                  className="shadow-inner appearance-none border-2 border-gray-200 rounded-xl w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-4 focus:ring-green-200 focus:border-green-400 transition-all duration-200"
                  rows="4"
                  placeholder="รายละเอียดเพิ่มเติม"
                ></textarea>
              </div>
              <div className="flex justify-center mt-8 space-x-4">
                <button
                  type="submit"
                  className="px-8 py-3 bg-gradient-to-r from-teal-500 to-green-600 text-white font-bold rounded-full shadow-lg hover:from-teal-600 hover:to-green-700 transform transition-all duration-300 hover:scale-105 focus:outline-none focus:ring-4 focus:ring-teal-500 focus:ring-opacity-50"
                >
                  เพิ่มข้อมูลการขนส่งนี้
                </button>
              </div>
            </form>
            {message && (
              <div className="mt-6 p-4 rounded-xl text-center bg-green-100 text-green-800 shadow-inner animate-fade-in">
                {message}
              </div>
            )}
            {jobDetails.length > 0 && (
              <div className="mt-8 w-full">
                <h3 className="text-xl font-bold text-gray-800 mb-4 text-center">รายการที่เพิ่มแล้ว</h3>
                <div className="space-y-4">
                  {jobDetails.map((job, index) => (
                    <div key={index} className="p-4 bg-gray-50 rounded-lg shadow-inner flex flex-col md:flex-row justify-between items-start md:items-center animate-fade-in">
                      <div className="flex-1 text-sm text-gray-700">
                        <p><strong>รายการที่ {index + 1}:</strong></p>
                        <p>ประเภทรถ: {job.vehicleType1} / {job.vehicleType2}</p>
                        <p>ประเภทการขนส่ง: {job.shippingType}</p>
                        <p>เส้นทาง: {job.origin} &rarr; {job.destination}</p>
                        <p>ประเภทสินค้า: {job.productType} ({job.weight} กก.)</p>
                        {job.otherDetails && <p>รายละเอียดอื่นๆ: {job.otherDetails}</p>}
                      </div>
                      <button
                        onClick={() => handleRemoveJob(index)}
                        className="mt-4 md:mt-0 px-4 py-2 bg-red-500 text-white font-semibold rounded-full shadow-md hover:bg-red-600 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-red-400"
                      >
                        ลบ
                      </button>
                    </div>
                  ))}
                </div>
              </div>
            )}
            <div className="mt-8">
              <button
                onClick={handleFinalSubmit}
                disabled={isSubmitting}
                className={`px-10 py-4 font-bold rounded-full shadow-lg transform transition-all duration-300 focus:outline-none focus:ring-4 focus:ring-offset-2 ${isSubmitting ? 'bg-gray-400 text-gray-700 cursor-not-allowed' : 'bg-gradient-to-r from-emerald-500 to-lime-600 text-white hover:from-emerald-600 hover:to-lime-700 hover:scale-105 focus:ring-lime-400 focus:ring-opacity-50'}`}
              >
                {isSubmitting ? `กำลังส่งข้อมูล ${submittedCount}/${jobDetails.length}...` : 'ยืนยันการส่งข้อมูลทั้งหมด'}
              </button>
            </div>
          </div>
        );
      };

      const SubmissionSuccess = () => (
        <div className="flex flex-col items-center justify-center p-8 bg-white rounded-2xl shadow-2xl max-w-2xl mx-auto my-12 animate-fade-in">
          <h2 className="text-2xl md:text-3xl font-bold text-gray-800 mb-4">ส่งข้อมูลเรียบร้อยแล้ว!</h2>
          <p className="text-lg text-gray-700 mb-6">
            เจ้าหน้าที่กำลังดำเนินการตรวจสอบข้อมูลของคุณ ก่อนเพิ่มในหน้าค้นหางานประมูล
          </p>
          <p className="text-md text-gray-700">
            ขอบคุณที่ใช้บริการ บริษัท เอส เอส แอล โลจิสติกส์ ครับ
          </p>
        </div>
      );

      return (
        <div className="min-h-screen bg-gradient-to-br from-green-50 to-emerald-100 font-kanit antialiased">
          <div className="p-6 bg-white bg-opacity-80 backdrop-filter backdrop-blur-lg shadow-lg mb-2 rounded-b-2xl animate-fade-in max-w-2xl mx-auto">
              <div className="text-center">
                  <h1 className="text-3xl md:text-4xl font-extrabold text-green-800 mb-2">ฝากโพสประมูลงาน</h1>
                  <p className="text-lg md:text-xl font-semibold text-green-700">ฝากประมูลงานขนส่งกับผู้รับเหมาทั่วประเทศ ผ่าน บริษัท เอส เอส แอล โลจิสติกส์ ได้ทีนี่</p>
              </div>
          </div>
          <div className="container mx-auto p-4">
            {currentPage === 'disclaimer' && <DisclaimerPage />}
            {currentPage === 'contact' && <ContactForm />}
            {currentPage === 'job_details' && !submissionSuccess && <JobDetailsForm />}
            {submissionSuccess && <SubmissionSuccess />}
          </div>
        </div>
      );
    };

    ReactDOM.render(<App />, document.getElementById('root'));

  </script>
</body>
</html>




